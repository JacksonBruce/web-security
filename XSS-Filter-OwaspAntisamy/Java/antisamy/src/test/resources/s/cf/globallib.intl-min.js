var cnnWeather=(typeof Class=="object")?Class.create():{};cnnWeather={config:{activated:true,weatherCdnPath:"http://i.cdn.turner.com/cnn/.e/img/3.0/weather/",weatherUrl:"http://svcs.cnn.com/weather/getForecast",iconSmallPath:"01/",iconLargePath:"03/",shortName:["SUN","MON","TUE","WED","THU","FRI","SAT"],weatherDivs:["cnnLWPWeather","user_weather"],weatherLink:"http://weather.cnn.com/weather/",weatherLinkIntl:"http://weather.edition.cnn.com/weather/intl/",forecastLink:"",requestTimer:"",requestAttempts:30,editionPref:""},data:{celsius:false,locCode:"",zipCode:""},init:function(){if(this.config.activated){this.config.requestTimer=setInterval(this.testCSIReady,500);}},testCSIReady:function(){cnnWeather.config.requestAttempts--;if(typeof CSIManager.getInstance!=="undefined"){cnnWeather.setData();clearInterval(cnnWeather.config.requestTimer);}else{if(typeof CSIManager.getInstance==="undefined"&&cnnWeather.config.requestAttempts>0){cnnWeather.testCSIReady();}else{}}},setData:function(){if(typeof CNN_getCookies==="function"){var g=CNN_getCookies();var d=g["lwp.weather"]||null;if(location.hostname.indexOf("edition")>-1){this.data.celsius=true;}else{this.data.celsius=false;}if(d){var b=unescape(d).split("|");var f=b[0];if(d.indexOf("~")==-1){f=d.replace("|","~");}var a=b[0].split("~");this.data.locCode=a[0];this.data.zipCode=a[1];this.requestWeather();}else{var e=this.randomCityZip();this.data.zipCode=e[0];this.data.locCode=e[1];this.requestWeather();}if(location.hostname.indexOf("edition")>-1){this.config.forecastLink=this.config.weatherLinkIntl+"forecast.jsp?&zipCode="+this.data.zipCode;}else{this.config.forecastLink=this.config.weatherLink+"forecast.jsp?zipCode="+this.data.zipCode;}}else{}},requestWeather:function(){var a=this.config.weatherUrl;var c="mode=json_html&zipCode="+this.data.zipCode+"&locCode="+this.data.locCode+"&celcius="+this.data.celsius;var b={url:a,args:c,domId:false,funcObj:this.requestHandler,breakCache:true};CSIManager.getInstance().callObject(b,"requestWeather");},requestHandler:function(e){if(typeof e==="object"){cnnWeather.data=e[0];for(var c=0;c<cnnWeather.data.forecast.days.length;c++){var a=parseFloat(cnnWeather.data.forecast.days[c].dayDate.day);cnnWeather.data.forecast.days[c].shortName=cnnWeather.config.shortName[a];var b=parseFloat(cnnWeather.data.forecast.days[c].high);var d=parseFloat(cnnWeather.data.forecast.days[c].low);cnnWeather.data.forecast.days[c].average=Math.floor((b+d)/2);cnnWeather.data.forecast.days[c].icon=cnnWeather.gif2png(cnnWeather.data.forecast.days[c].icon);}cnnWeather.ui();}else{}},ui:function(){for(i=0;i<cnnWeather.config.weatherDivs.length;i++){var a=cnnWeather.config.weatherDivs[i];var b=$(a);if(typeof cnnWeather.html[a]==="function"&&b){cnnWeather.html[a].apply();}else{}}},randomCityZip:function(){if(location.hostname.indexOf("edition")>-1){var d=["336736767676"];var c=["EGLL"];var a=[d[0],c[0]];return a;}else{var d=["27374","95614","87901","74446","31041","65570","29112","79031","25902"];var c=["NC26","CAPL","NM12","MUSX","09GA","TBN","USSC08","30TX","BLF"];var b=Math.floor(Math.random()*d.length);var a=[d[b],c[b]];return a;}},gif2png:function(a){var a=a.split(".");a=a[0];a+=".png";return a;}};cnnWeather.html={};cnnWeather.html.cnnLWPWeather=function(){if(cnnWeather.data.currentConditions.valid==false){cnnWeather.data.currentConditions.temperature="--";cnnWeather.data.currentConditions.icon="na_sm";}var a=(cnnWeather.data.currentConditions.temperature_S==="N/A")?'<span style="font-size: 50%;">N/A</span>':cnnWeather.data.currentConditions.temperature_S+"&deg;";var c='<div class="cnn_ftrwthr1">';c+='	<a href="'+cnnWeather.config.forecastLink+'" title=""><img src="'+cnnWeather.config.weatherCdnPath+cnnWeather.config.iconLargePath+cnnWeather.data.currentConditions.icon+'.png" width="54" height="47" alt="" class="cnn_ie6png" border="0"></a>';c+="</div>";c+='<div class="cnn_ftrwthr2"><div class="cnn_ftrwthr3">'+a+"</div>";c+='<div class="cnn_ftrwthr4"><div>HI '+cnnWeather.data.forecast.days[0].high+'&deg;<span style="padding-left:7px">LO '+cnnWeather.data.forecast.days[0].low+"&deg;</span></div>";c+='<div style="clear:left; line-height: 13px"><span style="padding-right:6px"><strong>'+cnnWeather.data.location.city+", "+cnnWeather.data.location.stateOrCountry+"</strong>";c+='</span><a href="'+cnnWeather.config.forecastLink+'">Weather forecast</a></div></div></div>';var b=$("cnnLWPWeather");$("cnnLWPWeather").innerHTML=c;$("cnnLWPWeather").style.visibility="visible";};cnnWeather.html.user_weather=function(){$("weather_act").innerHTML=cnnWeather.data.location.city+", "+cnnWeather.data.location.stateOrCountry;$("weather_format_img").href=cnnWeather.config.forecastLink;var a=(cnnWeather.data.currentConditions.temperature_S==="N/A")?'<span style="font-size: 50%;">N/A</span>':cnnWeather.data.currentConditions.temperature_S+"&deg;";var b="";b+='<a href="'+cnnWeather.config.forecastLink+'" title=""><img class="cnn_ie6png" src="'+cnnWeather.config.weatherCdnPath+cnnWeather.config.iconLargePath+cnnWeather.data.currentConditions.icon+'.png" width="57" height="47" alt="Current Weather" ></a>';$("weather_icon").innerHTML=b;b="";b+="<h1>"+a+"</h1>";b+='<h2 id="weather_hi">HI '+cnnWeather.data.forecast.days[0].high+"&deg;</h2>";b+='<h2 id="weather_lo">LO '+cnnWeather.data.forecast.days[0].low+"&deg;</h2>";$("weather_temp").innerHTML=b;b="";b+='<div class="wth_3daycol"><img class="cnn_ie6png" src="'+cnnWeather.config.weatherCdnPath+cnnWeather.config.iconSmallPath+cnnWeather.data.forecast.days[1].icon+'" width="21" height="17" alt="">';b+='<div class="w_day">'+cnnWeather.data.forecast.days[1].shortName+'</div><div class="w_temp">'+cnnWeather.data.forecast.days[1].average+"&deg;</div></div>";b+='<div class="wth_3daycol"><img class="cnn_ie6png" src="'+cnnWeather.config.weatherCdnPath+cnnWeather.config.iconSmallPath+cnnWeather.data.forecast.days[2].icon+'" width="21" height="17" alt="">';b+='<div class="w_day">'+cnnWeather.data.forecast.days[2].shortName+'</div><div class="w_temp">'+cnnWeather.data.forecast.days[2].average+"&deg;</div></div>";b+='<div class="wth_3daycol_last"><img class="cnn_ie6png" src="'+cnnWeather.config.weatherCdnPath+cnnWeather.config.iconSmallPath+cnnWeather.data.forecast.days[3].icon+'" width="21" height="17" alt="" >';b+='<div class="w_day">'+cnnWeather.data.forecast.days[3].shortName+'</div><div class="w_temp">'+cnnWeather.data.forecast.days[3].average+'&deg;</div></div><div class="clear"></div>';$("weather_3day").innerHTML=b;$("user_weather").style.visibility="visible";};Event.observe(window,"load",function(){cnnWeather.init();});var cnn_edtnswtchcnfg={};var t_selectededition="";function cnn_initeditionhtml(a){cnn_edtnisforced=a;CSIManager.getInstance().call("/.element/ssi/misc/3.0/editionvars.html","","cnn_hdr-promptcntnt",cnn_loadeditionhtml);}function cnn_loadeditionhtml(b){cnn_edtnswtchcnfg=b;if(cnn_edtnisforced){if(cnn_edtnisforced==3){if(t_selectededition==""){t_selectededition=allCookies["SelectedEdition"];}var a='<span id="hdr-prompt-text"><form>Please select your default edition:<b><input type="radio" name="cnn_edselect" value="" onclick="cnn_stedtnckie(\'edition\');"';if(t_selectededition=="edition"){a+=" checked";}a+='> International</b><b><input type="radio" name="cnn_edselect" value="" onclick="cnn_stedtnckie(\'www\');"';if(t_selectededition=="www"){a+=" checked";}a+='> U.S.</b><b><input type="radio" name="cnn_edselect" value="" onclick="cnn_stedtnckie(\'mexico\');"';if(t_selectededition=="mexico"){a+=" checked";}a+='> Mexico</b></form></span><img id="cnn_hdr-arrow" src="http://i.cdn.turner.com/cnn/.e/img/3.0/1px.gif" width="1" height="1" class="hdr-arrow-us2 cnn_dynone" />';}else{var a=(cnn_edtnisforced==1)?cnn_edtnswtchcnfg[cnn_edtnswtchver].edtn_msgs.def_msg:cnn_edtnswtchcnfg[cnn_edtnswtchver].edtn_msgs.sm_msg;}t_html=a+cnn_edtnswtchcnfg["edtn_clshtml"];}else{if(cnn_adcntryckie&&cnn_hasCG){t_html=cnn_edtnswtchcnfg[cnn_edtnswtchver].get_cntrymsg(cnn_adcntryckie)+cnn_edtnswtchcnfg["edtn_clshtml"];
}else{if(cnn_userbrwsrlng){t_html=cnn_edtnswtchcnfg[cnn_edtnswtchver].edtn_msgs.brwsr_msg+cnn_edtnswtchcnfg["edtn_clshtml"];}}}cnn_shweditionhtml();return t_html;}function cnn_shweditionhtml(){if(Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6){$("cnn_hdr-prompt").style.display="block";}else{Effect.SlideDown("cnn_hdr-prompt",{duration:0.7,afterFinish:function(){$("cnn_hdr-arrow").style.display="block";}});}}function cnn_clseditionhtml(){if(Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6){$("cnn_hdr-prompt").style.display="none";}else{Effect.SlideUp("cnn_hdr-prompt",{duration:0.5});}}function cnn_delayeditionhtml(a,b){if(!b){b=720;}if((b==168)&&!cnn_hasCG){cnn_stedtnckie("www");}else{CNN_setCookie("delayeditionhtml","delayed",b,"/",".cnn.com");}if(!a){cnn_clseditionhtml();}}function omniSwitchEdition(b){var a=s_gi("cnn3global");a.trackingServer="metrics.cnn.com";if(b=="edition"){b="intl";}if(b=="www"){b="us";}b=b+"pref";a.tl(this,"o",b);}function cnn_stedtnckie(b,a){CNN_setCookie("SelectedEdition",b,854400,"/",".cnn.com");omniSwitchEdition(b);t_selectededition=b;if(a){if(b=="www"){location.href="http://www.cnn.com/";}else{location.href="http://edition.cnn.com/";}}else{cnn_clseditionhtml();}}var cnn_queryargs=cnn_geturlqargs();var cnn_adcntryckie;var cnn_edtnisforced=0;var cnn_hasCG=false;var cnn_hasforeignb=false;var cnn_edtnChoice=allCookies["SelectedEdition"];var cnn_userbrwsrlng=(navigator.language)?navigator.language:navigator.userLanguage;if(allCookies["CG"]){cnn_adcntryckie=allCookies["CG"];cnn_adcntryckie=cnn_adcntryckie.split(":")[0];if((cnn_adcntryckie!="A2")&&(cnn_adcntryckie!="US")&&(cnn_adcntryckie!="A1")&&(cnn_adcntryckie!="O1")){cnn_hasCG=true;}}if(cnn_queryargs.cnn_shwEDDH){Event.observe(window,"load",function(){cnn_initeditionhtml(1);});}else{if((allCookies["delayeditionhtml"]!="delayed")&&!cnn_edtnChoice){if(cnn_edtnswtchver=="www"){if(cnn_hasCG){Event.observe(window,"load",function(){cnn_initeditionhtml();});}if(!cnn_hasCG&&cnn_userbrwsrlng&&(cnn_userbrwsrlng.toLowerCase()!="en-us")){cnn_hasforeignb=true;Event.observe(window,"load",function(){cnn_initeditionhtml();});}if(!cnn_hasforeignb&&!cnn_hasCG){Event.observe(window,"load",function(){cnn_initeditionhtml(1);});}}else{if(cnn_edtnswtchver=="edition"){if(cnn_adcntryckie=="MX"){Event.observe(window,"load",function(){cnn_initeditionhtml(2);});}else{Event.observe(window,"load",function(){cnn_initeditionhtml(1);});}}}CNN_setCookie("SelectedEdition",cnn_edtnswtchver,48,"/",".cnn.com");}}